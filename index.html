<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Daniel Duan</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:300,300i,600">
  <link rel="stylesheet" href="/style.css">
  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Daniel Duan" href="/feed.xml" />
  <!-- Begin Jekyll SEO tag v2.0.0 -->
<title>Daniel Duan - Daniel Duan thinks.</title>
<meta property="og:title" content="Daniel Duan" />
<meta name="description" content="Daniel Duan thinks." />
<meta property="og:description" content="Daniel Duan thinks." />
<link rel="canonical" href="http://dduan.net/" />
<meta property="og:url" content="http://dduan.net/" />
<meta property="og:site_name" content="Daniel Duan" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@daniel_duan" />
<meta name="twitter:creator" content="@Daniel Duan" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Daniel Duan",
    "headline": "Daniel Duan",
    "description": "Daniel Duan thinks.",
    "url": "http://dduan.net/"
  }
</script>
<!-- End Jekyll SEO tag -->
</head>
<body>
  <div class="container">
    <header class="masthead">
  <h1 class="masthead-title">
    <a href="/">Daniel Duan<span>&#39;s blog</span></a>
  </h1>
  <nav class="masthead-nav">
    
    <a href="/articles">articles</a>
    
    <a href="/links">Links</a>
    
    <a href="/projects">Projects</a>
    
    <a href="/about">About</a>
    
  </nav>
</header>
<div class="content page">
  <h3 class="page-title"></h3>
  


  
  <div class="content post">
    
    <h1 class="post-title"><a href="/2017/02/07/replying-to-old-mailing-list-threads/">Replying To Old Mailing List Threads</a></h1>
    
    <div class="post-date">
      
      <time>07 Feb 2017</time>
      
       |
      <div class="post-tags">
      
        <a href="/tag/swift-evolution">Swift Evolution</a>,
      
        <a href="/tag/email">Email</a>
      
      </div>
      
    </div>
    <p><em>One common complains on the Swift Evolution mailing list is about its
inscrutable interface. If you see an inactive thread on the web archive but
haven‚Äôt subscribed, there seems to be no way to participate or ‚Äúrevive‚Äù it
since you never received any of its emails.</em></p>

<p><em>With a <a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20170206/031537.html">hint</a> and some experiments, I‚Äôve discovered that there is
a way. This post reveals the magic step by step (without commenting on the
merits of email or this solution).</em></p>

<p>Like HTTP, Email is a text-based <a href="https://tools.ietf.org/html/rfc2822">protocol</a>. Unlike HTTP, we directly
consume payloads of this protocol and, as a consequence, don‚Äôt think much about
that very fact.</p>

<p>Like HTTP, each email includes headers hidden by normal email clients. Each
header is essentially two strings, a key and a value, separated by a colon.
Among these headers are <code class="highlighter-rouge">Message-Id</code> and <code class="highlighter-rouge">In-Reply-To</code>. When we tell our email
client applications to start a reply, they take the value from <code class="highlighter-rouge">Message-Id</code>
and use it as value for <code class="highlighter-rouge">In-Reply-To</code> automatically.</p>

<p>To observe all this in action, we can open some emails with our favorite text
editors and look for these headers. Of course, this require us to know where the
emails exist as files. On macOS, an easy thing to do is to drag from Mail.app to
Finder/Desktop and open the resulting .eml file:</p>

<p><img src="http://dduan.net/assets/2017/02/open-email.gif" alt="Open an email in text editors" /></p>

<p>Among the (perhaps overwhelming amount of) headers, we‚Äôll find the two fields we
are looking for:</p>

<p><img src="http://dduan.net/assets/2017/02/email-headers.png" alt="Email Headers Message-Id and
In-Reply-To" /></p>

<p>‚Ä¶ I‚Äôll leave the clients‚Äô reply behavior regarding these fields for the reader
to verify.</p>

<p>Mailing list software such as GNU Mailman, which <a href="https://swift.org">swift.org</a> and <a href="http://llvm.org">llvm.org</a>
use to host various mailing lists, associate emails in threads by chaining them
with the headers explained above, among other things. As long as we have
a message‚Äôs <code class="highlighter-rouge">Message-Id</code>, we can reply to it ‚Äúofficially‚Äù by adding its value to
the <code class="highlighter-rouge">In-Reply-To</code> header in our email, regardless of whether we have received
that email ourselves previously.</p>

<p>So here are the steps to reply retroactively to a mailing list thread.</p>

<ol>
  <li>
    <p><strong>find <code class="highlighter-rouge">Message-Id</code> of the mailing list message we want to reply to.</strong></p>

    <p>This value is contained in the mailing list web archive‚Äôs <code class="highlighter-rouge">mailto</code> link.
Unfortunately Mail.app doesn‚Äôt recognize it. It‚Äôs easy enough to find it
ourselves though:</p>

    <p><img src="http://dduan.net/assets/2017/02/find-message-id.gif" alt="Finding Message-Id on mailman
archive" /></p>

    <p>Note the <code class="highlighter-rouge">&lt;</code>, <code class="highlighter-rouge">&gt;</code>, <code class="highlighter-rouge">@</code> characters are percent-quoted. We have to recover the
id values to the format
<code class="highlighter-rouge">&lt;alphanumerics-potentially-separated-by-dash@address.com&gt;</code>.</p>

    <p>Another way to acquire this value is from the gzip‚Äôd archive. There they
just exist as plain text. The downside is you have to dig out the message
itself first.</p>
  </li>
  <li>
    <p><strong>Add <code class="highlighter-rouge">In-Reply-To</code> header to our email.</strong></p>

    <p>Draft a new email, make its title the same as our email chain‚Äôs title (this
is a good idea because lots of email <em>clients</em> do use the title to thread
messages). Set the appropriate recipients, and CCs, including the mailing
list‚Äôs address. Now save this email as draft and open it in a text editor as
we did in our investigations.  Add in the line
<code class="highlighter-rouge">In-Reply-To: &lt;id-we-found-in-step-one.address.com&gt;</code>, save it. Then send this
email (for example, open it with Mail.app and use Message-&gt;Send Again in the
menu).</p>

    <p>Of course, some email client <a href="http://www.pixelbeat.org/docs/thunderbird-threading.html">supports</a> adding it
from their GUI.</p>
  </li>
</ol>

<p>You‚Äôll find the in addition to functioning as an normal message to the
recipients, the mailing list will properly put your message to the original
thread (in the case of swift-evolution, only if your reply is within the same
week).</p>


  </div>
  <hr />
  
  <div class="content post">
    
    <h1 class="post-title"><a href="/2017/01/16/site-changes/">Site Improvements</a></h1>
    
    <div class="post-date">
      
      <time>16 Jan 2017</time>
      
       |
      <div class="post-tags">
      
        <a href="/tag/jekyll">Jekyll</a>
      
      </div>
      
    </div>
    <p>I spent a whole day making changes to this site.</p>

<p>You may notice a new section is now added: <a href="http://dduan.net/links">links</a>. Yes,
I want a link list format for this site. Often I find stuff that‚Äôs insightful
and not always visible. I want to collect those and bookmark them here.
Modelling after <a href="http://daringfireball.net">Daring Fireball</a>, I‚Äôve added a new
<a href="http://dduan.net/articles/feed.xml">feed</a> which only contains long-form,
original articles. I‚Äôll be tagging the links so that they show up along side my
normal posts in tag pages. Each tag page now gets its own feed! You can read
about it in the <a href="http://dduan.net/about/">about page</a>.</p>

<p>A few small issues has been fixed.</p>

<p>I wrote the most Ruby in my life today. Yay?</p>

  </div>
  <hr />
  
  <div class="content post">
    
    <h1 class="post-title"><a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20160808/026153.html">üîó Swift ABI In Layman's terms</a></h1>
    
    <div class="post-date">
      
      <a href="/linked/2017/01/swift-abi-in-laymans-terms/">
      
      <time>16 Jan 2017</time>
      
      </a>
      
       |
      <div class="post-tags">
      
        <a href="/tag/swift">Swift</a>
      
      </div>
      
    </div>
    <p>An oldie but goodie from Swift Evelution.
<a href="https://twitter.com/slava_pestov">Slava</a>‚Äôs answer:</p>

<blockquote>
  <p>‚Äúwhen we talk about the ABI, we‚Äôre really talking about three orthogonal
‚Äúaxes‚Äù along which we would like to ‚Äúmove‚Äù without breaking compatibility with
existing binaries:‚Äù</p>

  <ul>
    <li>
      <p>The first axis is the machine-level calling conventions and memory layout.
For example, what registers to pass function arguments and returns in, the
rules for alignment and padding of fields in an aggregate type, which entry
points the Swift runtime exports and what their behavior should be. Once we
commit to a stable ABI along this axis, you will get interoperability between
<em>compiler versions</em> ‚Äì the same exact library built with one version of the
compiler will remain compatible with clients after being recompiled with
another version, because their conventions will match up. Note that this does
not help you if the library itself changes in any way.</p>
    </li>
    <li>
      <p>The second axis is the resilience work I called out in my previous e-mail.
Here, we‚Äôre trying to define language features and implementation techniques
that allow a library to evolve in a forward-compatible manner, as long as the
developer follows certain guidelines. Here, the goal is if you should be able
to compile your library, make some changes to add new APIs, and recompile it
<em>with the same compiler</em>, without breaking downstream clients, as long as you
follow the library evolution guidelines (Also, you can imagine one day having
an ‚ÄòABI diff‚Äô tool to automate this).  &gt;</p>
    </li>
    <li>
      <p>The third axis is the standard library itself. Stability of runtime
interfaces and the extra indirection to enable resilience is all great, but it
won‚Äôt help you as long as the standard library API is evolving in a
non-backwards compatible manner ‚Äì for example, if we remove a method on
String. So once the other two areas have been addressed, the last thing to lock
down is the standard library interface itself.</p>
    </li>
  </ul>
</blockquote>

<p>The rest of the thread is worth reading too. John McCall gave an high level
<a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20160808/026145.html">description</a>.</p>

<p>The definitive source for Slava‚Äôs third axes is the <a href="https://github.com/apple/swift/blob/master/docs/LibraryEvolution.rst">Library
Evolution</a>
doc from the Swift repository.</p>

  </div>
  <hr />
  


<footer class="masthead">
<h4>Read More:</h4>
<nav class="masthead-nav">
  
  <a href="/articles">articles</a>
  
  <a href="/links">Links</a>
  
  <a href="/projects">Projects</a>
  
  <a href="/about">About</a>
  
</nav>
</footer>

</div>

  </div>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)
    },i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-59501714-1', 'auto');
    ga('send', 'pageview');
  </script>
</body>
</html>
